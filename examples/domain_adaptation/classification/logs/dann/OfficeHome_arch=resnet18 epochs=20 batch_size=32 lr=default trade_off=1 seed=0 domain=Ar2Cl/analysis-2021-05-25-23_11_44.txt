Namespace(arch='resnet18', batch_size=32, bottleneck_dim=256, center_crop=False, data='OfficeHome', epochs=20, iters_per_epoch=1000, log='examples/domain_adaptation/classification/logs/dann/OfficeHome_arch=resnet18 epochs=20 batch_size=32 lr=default trade_off=1 seed=0 domain=Ar2Cl', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, per_class_eval=False, phase='analysis', print_freq=100, root='examples/domain_adaptation/classification/data/office-home', seed=0, source='Ar', target='Cl', trade_off=1.0, weight_decay=0.001, workers=2)
C:\Users\ajays\MLResearch\Transfer-Learning-Library\examples\domain_adaptation\classification\dann.py:43: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
=> using pre-trained model 'resnet18'
  0%|                                                                                                                                                          | 0/75 [00:00<?, ?it/s]  1%|#9                                                                                                                                                | 1/75 [00:20<25:08, 20.39s/it]  7%|#########7                                                                                                                                        | 5/75 [00:20<03:34,  3.06s/it] 12%|#################5                                                                                                                                | 9/75 [00:21<01:41,  1.54s/it] 15%|#####################2                                                                                                                           | 11/75 [00:22<01:15,  1.18s/it] 16%|#######################2                                                                                                                         | 12/75 [00:22<01:07,  1.07s/it] 19%|###########################                                                                                                                      | 14/75 [00:23<00:49,  1.24it/s] 20%|#############################                                                                                                                    | 15/75 [00:23<00:41,  1.45it/s] 21%|##############################9                                                                                                                  | 16/75 [00:23<00:36,  1.62it/s] 23%|################################8                                                                                                                | 17/75 [00:23<00:30,  1.92it/s] 24%|##################################8                                                                                                              | 18/75 [00:24<00:27,  2.08it/s] 25%|####################################7                                                                                                            | 19/75 [00:24<00:23,  2.38it/s] 27%|######################################6                                                                                                          | 20/75 [00:24<00:21,  2.55it/s] 28%|########################################6                                                                                                        | 21/75 [00:25<00:20,  2.58it/s] 29%|##########################################5                                                                                                      | 22/75 [00:25<00:18,  2.93it/s] 31%|############################################4                                                                                                    | 23/75 [00:25<00:17,  2.97it/s] 32%|##############################################4                                                                                                  | 24/75 [00:26<00:15,  3.30it/s] 33%|################################################3                                                                                                | 25/75 [00:26<00:14,  3.54it/s] 35%|##################################################2                                                                                              | 26/75 [00:26<00:13,  3.56it/s] 36%|####################################################2                                                                                            | 27/75 [00:26<00:12,  3.89it/s] 37%|######################################################1                                                                                          | 28/75 [00:27<00:16,  2.81it/s] 40%|##########################################################                                                                                       | 30/75 [00:27<00:14,  3.07it/s] 43%|#############################################################8                                                                                   | 32/75 [00:28<00:12,  3.36it/s] 45%|#################################################################7                                                                               | 34/75 [00:28<00:11,  3.43it/s] 48%|#####################################################################6                                                                           | 36/75 [00:29<00:10,  3.63it/s] 51%|#########################################################################4                                                                       | 38/75 [00:30<00:10,  3.55it/s] 53%|#############################################################################3                                                                   | 40/75 [00:30<00:09,  3.51it/s] 56%|#################################################################################2                                                               | 42/75 [00:31<00:08,  3.69it/s] 59%|#####################################################################################                                                            | 44/75 [00:31<00:08,  3.46it/s] 61%|########################################################################################9                                                        | 46/75 [00:32<00:08,  3.32it/s] 64%|############################################################################################8                                                    | 48/75 [00:32<00:07,  3.47it/s] 67%|################################################################################################6                                                | 50/75 [00:33<00:07,  3.38it/s] 69%|####################################################################################################5                                            | 52/75 [00:34<00:06,  3.43it/s] 72%|########################################################################################################4                                        | 54/75 [00:34<00:06,  3.38it/s] 75%|############################################################################################################2                                    | 56/75 [00:35<00:05,  3.37it/s] 77%|################################################################################################################1                                | 58/75 [00:35<00:04,  3.56it/s] 80%|####################################################################################################################                             | 60/75 [00:36<00:04,  3.70it/s] 83%|#######################################################################################################################8                         | 62/75 [00:36<00:03,  3.56it/s] 85%|###########################################################################################################################7                     | 64/75 [00:37<00:03,  3.53it/s] 88%|###############################################################################################################################6                 | 66/75 [00:38<00:02,  3.56it/s] 91%|###################################################################################################################################4             | 68/75 [00:38<00:01,  3.59it/s] 93%|#######################################################################################################################################3         | 70/75 [00:39<00:01,  3.62it/s] 96%|###########################################################################################################################################2     | 72/75 [00:39<00:00,  3.59it/s] 99%|###############################################################################################################################################  | 74/75 [00:40<00:00,  3.69it/s]100%|#################################################################################################################################################| 75/75 [00:41<00:00,  1.81it/s]
  0%|                                                                                                                                                         | 0/136 [00:00<?, ?it/s]  1%|#                                                                                                                                                | 1/136 [00:18<40:35, 18.04s/it]  2%|###1                                                                                                                                             | 3/136 [00:18<10:38,  4.80s/it]  4%|#####3                                                                                                                                           | 5/136 [00:18<05:19,  2.44s/it]  5%|#######4                                                                                                                                         | 7/136 [00:19<03:10,  1.48s/it]  7%|#########5                                                                                                                                       | 9/136 [00:19<02:03,  1.03it/s]  8%|###########6                                                                                                                                    | 11/136 [00:19<01:26,  1.45it/s] 10%|#############7                                                                                                                                  | 13/136 [00:20<01:02,  1.96it/s] 11%|###############8                                                                                                                                | 15/136 [00:20<00:47,  2.54it/s] 12%|##################                                                                                                                              | 17/136 [00:20<00:37,  3.20it/s] 14%|####################1                                                                                                                           | 19/136 [00:20<00:30,  3.87it/s] 15%|######################2                                                                                                                         | 21/136 [00:21<00:25,  4.48it/s] 17%|########################3                                                                                                                       | 23/136 [00:21<00:22,  5.11it/s] 18%|##########################4                                                                                                                     | 25/136 [00:21<00:20,  5.51it/s] 20%|############################5                                                                                                                   | 27/136 [00:22<00:19,  5.56it/s] 21%|##############################7                                                                                                                 | 29/136 [00:22<00:17,  6.07it/s] 23%|################################8                                                                                                               | 31/136 [00:22<00:18,  5.78it/s] 24%|##################################9                                                                                                             | 33/136 [00:23<00:17,  6.04it/s] 26%|#####################################                                                                                                           | 35/136 [00:23<00:15,  6.37it/s] 27%|#######################################1                                                                                                        | 37/136 [00:23<00:14,  6.64it/s] 29%|#########################################2                                                                                                      | 39/136 [00:23<00:13,  6.94it/s] 30%|###########################################4                                                                                                    | 41/136 [00:24<00:14,  6.46it/s] 32%|#############################################5                                                                                                  | 43/136 [00:24<00:13,  6.69it/s] 33%|###############################################6                                                                                                | 45/136 [00:24<00:13,  6.83it/s] 35%|#################################################7                                                                                              | 47/136 [00:25<00:13,  6.62it/s] 36%|###################################################8                                                                                            | 49/136 [00:25<00:12,  6.69it/s] 38%|######################################################                                                                                          | 51/136 [00:25<00:12,  6.98it/s] 39%|########################################################1                                                                                       | 53/136 [00:25<00:13,  6.33it/s] 40%|##########################################################2                                                                                     | 55/136 [00:26<00:12,  6.45it/s] 42%|############################################################3                                                                                   | 57/136 [00:26<00:12,  6.16it/s] 43%|##############################################################4                                                                                 | 59/136 [00:26<00:12,  6.35it/s] 45%|################################################################5                                                                               | 61/136 [00:27<00:12,  6.02it/s] 46%|##################################################################7                                                                             | 63/136 [00:27<00:11,  6.54it/s] 48%|####################################################################8                                                                           | 65/136 [00:27<00:10,  6.86it/s] 49%|######################################################################9                                                                         | 67/136 [00:28<00:10,  6.31it/s] 51%|#########################################################################                                                                       | 69/136 [00:28<00:10,  6.43it/s] 52%|###########################################################################1                                                                    | 71/136 [00:28<00:09,  6.57it/s] 54%|#############################################################################2                                                                  | 73/136 [00:29<00:09,  6.39it/s] 55%|###############################################################################4                                                                | 75/136 [00:29<00:09,  6.33it/s] 57%|#################################################################################5                                                              | 77/136 [00:29<00:09,  6.32it/s] 58%|###################################################################################6                                                            | 79/136 [00:30<00:08,  6.56it/s] 60%|#####################################################################################7                                                          | 81/136 [00:30<00:08,  6.52it/s] 61%|#######################################################################################8                                                        | 83/136 [00:30<00:08,  6.16it/s] 62%|##########################################################################################                                                      | 85/136 [00:31<00:08,  6.24it/s] 64%|############################################################################################1                                                   | 87/136 [00:31<00:07,  6.13it/s] 65%|##############################################################################################2                                                 | 89/136 [00:31<00:07,  6.30it/s] 67%|################################################################################################3                                               | 91/136 [00:31<00:07,  6.30it/s] 68%|##################################################################################################4                                             | 93/136 [00:32<00:06,  6.79it/s] 70%|####################################################################################################5                                           | 95/136 [00:32<00:06,  6.77it/s] 71%|######################################################################################################7                                         | 97/136 [00:32<00:05,  6.75it/s] 73%|########################################################################################################8                                       | 99/136 [00:33<00:05,  6.96it/s] 74%|##########################################################################################################1                                    | 101/136 [00:33<00:04,  7.09it/s] 76%|############################################################################################################3                                  | 103/136 [00:33<00:04,  7.42it/s] 77%|##############################################################################################################4                                | 105/136 [00:33<00:03,  7.86it/s] 79%|################################################################################################################5                              | 107/136 [00:34<00:03,  7.84it/s] 80%|##################################################################################################################6                            | 109/136 [00:34<00:03,  7.79it/s] 82%|####################################################################################################################7                          | 111/136 [00:34<00:03,  7.85it/s] 83%|######################################################################################################################8                        | 113/136 [00:34<00:02,  7.81it/s] 85%|########################################################################################################################9                      | 115/136 [00:35<00:02,  7.94it/s] 86%|###########################################################################################################################                    | 117/136 [00:35<00:02,  7.90it/s] 88%|#############################################################################################################################1                 | 119/136 [00:35<00:02,  7.86it/s] 89%|###############################################################################################################################2               | 121/136 [00:35<00:01,  7.55it/s] 90%|#################################################################################################################################3             | 123/136 [00:36<00:01,  7.53it/s] 92%|###################################################################################################################################4           | 125/136 [00:36<00:01,  7.83it/s] 93%|#####################################################################################################################################5         | 127/136 [00:36<00:01,  7.72it/s] 95%|#######################################################################################################################################6       | 129/136 [00:36<00:00,  7.55it/s] 96%|#########################################################################################################################################7     | 131/136 [00:37<00:00,  7.83it/s] 98%|###########################################################################################################################################8   | 133/136 [00:37<00:00,  7.80it/s] 99%|#############################################################################################################################################9 | 135/136 [00:37<00:00,  6.99it/s]100%|###############################################################################################################################################| 136/136 [00:38<00:00,  3.51it/s]
Saving t-SNE to examples/domain_adaptation/classification/logs/dann/OfficeHome_arch=resnet18 epochs=20 batch_size=32 lr=default trade_off=1 seed=0 domain=Ar2Cl\visualize\TSNE.png
epoch 0 accuracy: 43.59733200073242 A-dist: -0.2561068534851074
epoch 1 accuracy: 64.39674377441406 A-dist: 0.5758697986602783
epoch 2 accuracy: 56.69873809814453 A-dist: 0.26794958114624023
epoch 3 accuracy: 61.58401107788086 A-dist: 0.4633603096008301
epoch 4 accuracy: 60.39970016479492 A-dist: 0.4159879684448242
epoch 5 accuracy: 60.695777893066406 A-dist: 0.42783117294311523
epoch 6 accuracy: 64.76683807373047 A-dist: 0.5906734466552734
epoch 7 accuracy: 51.44337463378906 A-dist: 0.05773496627807617
epoch 8 accuracy: 65.80310821533203 A-dist: 0.6321241855621338
epoch 9 accuracy: 62.84233856201172 A-dist: 0.5136935710906982
A-distance = tensor(0.5137, device='cuda:0')
