Namespace(arch='resnet18', batch_size=32, bottleneck_dim=256, center_crop=False, data='OfficeHome', epochs=25, iters_per_epoch=1000, log='examples/domain_adaptation/classification/logs/dann/OfficeHome_ArCl', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, per_class_eval=False, phase='analysis', print_freq=100, root='examples/domain_adaptation/classification/data/office-home', seed=0, source='Ar', target='Cl', trade_off=1.0, weight_decay=0.001, workers=2)
C:\Users\ajays\MLResearch\Transfer-Learning-Library\examples\domain_adaptation\classification\dann.py:42: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
=> using pre-trained model 'resnet18'
  0%|                                                                                                                                                                                | 0/75 [00:00<?, ?it/s]  1%|##2                                                                                                                                                                     | 1/75 [00:11<14:06, 11.43s/it]  7%|###########2                                                                                                                                                            | 5/75 [00:11<02:00,  1.73s/it] 12%|####################1                                                                                                                                                   | 9/75 [00:12<00:59,  1.12it/s] 15%|########################4                                                                                                                                              | 11/75 [00:12<00:44,  1.43it/s] 17%|############################9                                                                                                                                          | 13/75 [00:13<00:35,  1.76it/s] 19%|###############################1                                                                                                                                       | 14/75 [00:13<00:32,  1.85it/s] 20%|#################################4                                                                                                                                     | 15/75 [00:13<00:27,  2.20it/s] 21%|###################################6                                                                                                                                   | 16/75 [00:14<00:25,  2.33it/s] 23%|#####################################8                                                                                                                                 | 17/75 [00:14<00:20,  2.85it/s] 24%|########################################                                                                                                                               | 18/75 [00:14<00:19,  2.92it/s] 25%|##########################################3                                                                                                                            | 19/75 [00:14<00:16,  3.30it/s] 27%|############################################5                                                                                                                          | 20/75 [00:14<00:16,  3.43it/s] 28%|##############################################7                                                                                                                        | 21/75 [00:15<00:16,  3.18it/s] 29%|################################################9                                                                                                                      | 22/75 [00:15<00:13,  3.93it/s] 31%|###################################################2                                                                                                                   | 23/75 [00:15<00:14,  3.64it/s] 32%|#####################################################4                                                                                                                 | 24/75 [00:15<00:12,  4.21it/s] 33%|#######################################################6                                                                                                               | 25/75 [00:16<00:12,  4.08it/s] 35%|#########################################################8                                                                                                             | 26/75 [00:16<00:11,  4.42it/s] 36%|############################################################1                                                                                                          | 27/75 [00:16<00:10,  4.52it/s] 37%|##############################################################3                                                                                                        | 28/75 [00:16<00:12,  3.77it/s] 40%|##################################################################8                                                                                                    | 30/75 [00:17<00:11,  3.96it/s] 43%|#######################################################################2                                                                                               | 32/75 [00:17<00:10,  4.13it/s] 45%|###########################################################################7                                                                                           | 34/75 [00:18<00:09,  4.26it/s] 48%|################################################################################1                                                                                      | 36/75 [00:18<00:08,  4.49it/s] 51%|####################################################################################6                                                                                  | 38/75 [00:19<00:08,  4.59it/s] 53%|#########################################################################################                                                                              | 40/75 [00:19<00:07,  4.65it/s] 56%|#############################################################################################5                                                                         | 42/75 [00:19<00:06,  4.77it/s] 59%|#################################################################################################9                                                                     | 44/75 [00:20<00:07,  4.41it/s] 61%|######################################################################################################4                                                                | 46/75 [00:20<00:06,  4.44it/s] 64%|##########################################################################################################8                                                            | 48/75 [00:21<00:05,  4.63it/s] 67%|###############################################################################################################3                                                       | 50/75 [00:21<00:05,  4.48it/s] 69%|###################################################################################################################7                                                   | 52/75 [00:22<00:04,  4.65it/s] 72%|########################################################################################################################2                                              | 54/75 [00:22<00:04,  4.67it/s] 75%|############################################################################################################################6                                          | 56/75 [00:23<00:04,  4.60it/s] 77%|#################################################################################################################################1                                     | 58/75 [00:23<00:03,  4.70it/s] 80%|#####################################################################################################################################6                                 | 60/75 [00:23<00:03,  4.68it/s] 83%|##########################################################################################################################################                             | 62/75 [00:24<00:02,  4.60it/s] 85%|##############################################################################################################################################5                        | 64/75 [00:24<00:02,  4.71it/s] 88%|##################################################################################################################################################9                    | 66/75 [00:25<00:01,  4.92it/s] 91%|#######################################################################################################################################################4               | 68/75 [00:25<00:01,  4.83it/s] 93%|###########################################################################################################################################################8           | 70/75 [00:25<00:01,  4.95it/s] 96%|################################################################################################################################################################3      | 72/75 [00:26<00:00,  4.76it/s] 99%|####################################################################################################################################################################7  | 74/75 [00:26<00:00,  4.90it/s]100%|#######################################################################################################################################################################| 75/75 [00:27<00:00,  2.69it/s]
  0%|                                                                                                                                                                               | 0/136 [00:00<?, ?it/s]  1%|#2                                                                                                                                                                     | 1/136 [00:10<22:37, 10.06s/it]  2%|###6                                                                                                                                                                   | 3/136 [00:10<05:57,  2.69s/it]  4%|######1                                                                                                                                                                | 5/136 [00:10<03:02,  1.39s/it]  5%|########5                                                                                                                                                              | 7/136 [00:10<01:49,  1.18it/s]  7%|###########                                                                                                                                                            | 9/136 [00:11<01:12,  1.75it/s]  8%|#############4                                                                                                                                                        | 11/136 [00:11<00:51,  2.43it/s] 10%|###############8                                                                                                                                                      | 13/136 [00:11<00:38,  3.20it/s] 11%|##################3                                                                                                                                                   | 15/136 [00:11<00:30,  4.01it/s] 12%|####################7                                                                                                                                                 | 17/136 [00:11<00:24,  4.83it/s] 14%|#######################1                                                                                                                                              | 19/136 [00:12<00:19,  5.90it/s] 15%|#########################6                                                                                                                                            | 21/136 [00:12<00:17,  6.60it/s] 17%|############################                                                                                                                                          | 23/136 [00:12<00:15,  7.33it/s] 18%|##############################5                                                                                                                                       | 25/136 [00:12<00:14,  7.77it/s] 20%|################################9                                                                                                                                     | 27/136 [00:13<00:14,  7.43it/s] 21%|###################################3                                                                                                                                  | 29/136 [00:13<00:13,  8.01it/s] 23%|#####################################8                                                                                                                                | 31/136 [00:13<00:13,  7.69it/s] 24%|########################################2                                                                                                                             | 33/136 [00:13<00:12,  8.25it/s] 26%|##########################################7                                                                                                                           | 35/136 [00:13<00:11,  8.64it/s] 27%|#############################################1                                                                                                                        | 37/136 [00:14<00:11,  8.89it/s] 29%|###############################################6                                                                                                                      | 39/136 [00:14<00:10,  8.91it/s] 30%|##################################################                                                                                                                    | 41/136 [00:14<00:11,  8.49it/s] 32%|####################################################4                                                                                                                 | 43/136 [00:14<00:10,  8.67it/s] 33%|######################################################9                                                                                                               | 45/136 [00:15<00:10,  8.80it/s] 35%|#########################################################3                                                                                                            | 47/136 [00:15<00:10,  8.42it/s] 36%|###########################################################8                                                                                                          | 49/136 [00:15<00:09,  8.92it/s] 38%|##############################################################2                                                                                                       | 51/136 [00:15<00:09,  9.20it/s] 39%|################################################################6                                                                                                     | 53/136 [00:15<00:08,  9.45it/s] 40%|###################################################################1                                                                                                  | 55/136 [00:16<00:08, 10.06it/s] 42%|#####################################################################5                                                                                                | 57/136 [00:16<00:08,  9.81it/s] 43%|########################################################################                                                                                              | 59/136 [00:16<00:07,  9.64it/s] 45%|##########################################################################4                                                                                           | 61/136 [00:16<00:08,  8.57it/s] 46%|############################################################################8                                                                                         | 63/136 [00:17<00:08,  8.94it/s] 48%|###############################################################################3                                                                                      | 65/136 [00:17<00:07,  9.04it/s] 49%|#################################################################################7                                                                                    | 67/136 [00:17<00:08,  8.46it/s] 51%|####################################################################################2                                                                                 | 69/136 [00:17<00:07,  8.75it/s] 52%|######################################################################################6                                                                               | 71/136 [00:17<00:06,  9.30it/s] 54%|#########################################################################################1                                                                            | 73/136 [00:18<00:06,  9.69it/s] 55%|###########################################################################################5                                                                          | 75/136 [00:18<00:06,  9.73it/s] 57%|#############################################################################################9                                                                        | 77/136 [00:18<00:06,  9.58it/s] 58%|################################################################################################4                                                                     | 79/136 [00:18<00:05,  9.50it/s] 60%|##################################################################################################8                                                                   | 81/136 [00:18<00:05,  9.48it/s] 61%|#####################################################################################################3                                                                | 83/136 [00:19<00:05,  9.64it/s] 62%|#######################################################################################################7                                                              | 85/136 [00:19<00:05,  9.72it/s] 64%|##########################################################################################################1                                                           | 87/136 [00:19<00:05,  9.55it/s] 65%|############################################################################################################6                                                         | 89/136 [00:19<00:04,  9.69it/s] 67%|###############################################################################################################                                                       | 91/136 [00:20<00:04,  9.47it/s] 68%|#################################################################################################################5                                                    | 93/136 [00:20<00:04,  9.54it/s] 70%|###################################################################################################################9                                                  | 95/136 [00:20<00:04,  8.86it/s] 71%|######################################################################################################################3                                               | 97/136 [00:20<00:04,  8.68it/s] 73%|########################################################################################################################8                                             | 99/136 [00:20<00:04,  8.81it/s] 74%|##########################################################################################################################5                                          | 101/136 [00:21<00:03,  8.90it/s] 76%|############################################################################################################################9                                        | 103/136 [00:21<00:03,  9.10it/s] 77%|###############################################################################################################################3                                     | 105/136 [00:21<00:03,  9.48it/s] 79%|#################################################################################################################################8                                   | 107/136 [00:21<00:03,  9.40it/s] 80%|####################################################################################################################################2                                | 109/136 [00:21<00:02,  9.38it/s] 82%|######################################################################################################################################6                              | 111/136 [00:22<00:02,  9.66it/s] 83%|#########################################################################################################################################                            | 113/136 [00:22<00:02,  9.36it/s] 85%|###########################################################################################################################################5                         | 115/136 [00:22<00:02,  9.38it/s] 86%|#############################################################################################################################################9                       | 117/136 [00:22<00:01,  9.70it/s] 88%|################################################################################################################################################3                    | 119/136 [00:23<00:01,  9.69it/s] 89%|##################################################################################################################################################8                  | 121/136 [00:23<00:01,  9.46it/s] 90%|#####################################################################################################################################################2               | 123/136 [00:23<00:01,  9.38it/s] 92%|#######################################################################################################################################################6             | 125/136 [00:23<00:01,  9.68it/s] 93%|##########################################################################################################################################################           | 127/136 [00:23<00:00,  9.69it/s] 95%|############################################################################################################################################################5        | 129/136 [00:24<00:00,  9.59it/s] 96%|##############################################################################################################################################################9      | 131/136 [00:24<00:00,  9.68it/s] 98%|#################################################################################################################################################################3   | 133/136 [00:24<00:00,  9.53it/s] 99%|###################################################################################################################################################################7 | 135/136 [00:24<00:00,  8.68it/s]100%|#####################################################################################################################################################################| 136/136 [00:25<00:00,  5.27it/s]
Saving t-SNE to examples/domain_adaptation/classification/logs/dann/OfficeHome_ArCl\visualize\TSNE.png
epoch 0 accuracy: 49.29681396484375 A-dist: -0.028127431869506836
epoch 1 accuracy: 62.694297790527344 A-dist: 0.5077719688415527
epoch 2 accuracy: 55.44041061401367 A-dist: 0.21761631965637207
epoch 3 accuracy: 65.43301391601562 A-dist: 0.6173205375671387
epoch 4 accuracy: 57.2908935546875 A-dist: 0.29163575172424316
epoch 5 accuracy: 61.287933349609375 A-dist: 0.45151734352111816
epoch 6 accuracy: 65.58104705810547 A-dist: 0.6232419013977051
epoch 7 accuracy: 56.55070114135742 A-dist: 0.2620279788970947
epoch 8 accuracy: 65.58104705810547 A-dist: 0.6232419013977051
epoch 9 accuracy: 63.064395904541016 A-dist: 0.522575855255127
A-distance = tensor(0.5226, device='cuda:0')
